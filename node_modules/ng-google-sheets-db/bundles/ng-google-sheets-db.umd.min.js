!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("rxjs/operators"),require("@angular/core"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("ng-google-sheets-db",["exports","rxjs","rxjs/operators","@angular/core","@angular/common/http"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["ng-google-sheets-db"]={},e.rxjs,e.rxjs.operators,e.ng.core,e.ng.common.http)}(this,(function(e,t,r,o,n){"use strict";var i=new o.InjectionToken("Google Sheets API key"),s=function(){function e(e,t){this.http=e,this.apiKey=t,this.defaultActiveValues=["true","1","yes"]}return e.prototype.get=function(e,t,o){var n=this;return this.getRows(e,t).pipe(r.map((function(e){return n.rowsToEntries(e).map((function(e){return n.getObjectFromEntry(e,o)}))})))},e.prototype.getActive=function(e,t,o,n,i){var s=this;return void 0===n&&(n="is_active"),void 0===i&&(i=null),null===i?i=this.defaultActiveValues:Array.isArray(i)||(i=[i]),this.getRows(e,t).pipe(r.map((function(e){return s.rowsToEntries(e).filter((function(e){return i.includes(e[n].toLowerCase())})).map((function(e){return s.getObjectFromEntry(e,o)}))})))},e.prototype.getSpreadsheetUrl=function(e,t){return"https://sheets.googleapis.com/v4/spreadsheets/"+e+"/values/"+encodeURI(t)+"?key="+this.apiKey},e.prototype.getRows=function(e,t){var o=this.getSpreadsheetUrl(e,t);return this.http.get(o).pipe(r.map((function(e){return e.values})),r.catchError(this.handleError))},e.prototype.rowsToEntries=function(e){var t=e[0].map(this.cleanColumnName);return e.slice(1).map((function(e){return t.reduce((function(t,r,o){return t[r]=e.length>o?e[o]:"",t}),{})}))},e.prototype.cleanColumnName=function(e){return e.trim()},e.prototype.arrayToObject=function(e){return e.reduce((function(e,t){return e[t]=t,e}),{})},e.prototype.getObjectFromEntry=function(e,t){return Array.isArray(t)&&(t=this.arrayToObject(t)),this.getObjectFromEntryObject(e,t)},e.prototype.getObjectFromEntryObject=function(e,t,r){void 0===r&&(r="");var o={};for(var n in Object(t))if(t.hasOwnProperty(n)&&!["_prefix","_listField"].includes(n))if("string"==typeof t[n])o[n]=this.getValueFromEntry(e,r+t[n]);else if("object"==typeof t[n]){var i="";t[n].hasOwnProperty("_prefix")&&(i=t[n]._prefix),t[n]._listField?o[n]=this.getListFromEntry(e,r+i):o[n]=this.getObjectFromEntryObject(e,t[n],r+i)}else console.log("Unknown type for "+n);return o},e.prototype.getValueFromEntry=function(e,t){return t=this.cleanColumnName(t),e.hasOwnProperty(t)?e[t]:null},e.prototype.getListFromEntry=function(e,t){for(var r=[],o=1,n=this.getValueFromEntry(e,""+t+o);n;)r.push(n),o++,n=this.getValueFromEntry(e,""+t+o);return r},e.prototype.handleError=function(e){return e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):console.error("Backend returned code "+e.status+", body was: "+e.error),t.throwError("Something bad happened; please try again later.")},e}();s.ɵprov=o.ɵɵdefineInjectable({factory:function(){return new s(o.ɵɵinject(n.HttpClient),o.ɵɵinject(i))},token:s,providedIn:"root"}),s.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],s.ctorParameters=function(){return[{type:n.HttpClient},{type:String,decorators:[{type:o.Inject,args:[i]}]}]},e.API_KEY=i,e.GoogleSheetsDbService=s,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ng-google-sheets-db.umd.min.js.map